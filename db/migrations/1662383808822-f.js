module.exports = class f1662383808822 {
  name = 'f1662383808822'

  async up(db) {
    await db.query(`CREATE TABLE "round_nominator" ("id" character varying NOT NULL, "account" text NOT NULL, "bond" numeric, "round_id" character varying NOT NULL, CONSTRAINT "PK_198962b34d30551579fc4fc9d1c" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_51c3d9f8e416a26186881e95cc" ON "round_nominator" ("round_id") `)
    await db.query(`CREATE INDEX "IDX_321b9eb24f8fa2d07a70406a05" ON "round_nominator" ("account") `)
    await db.query(`CREATE TABLE "round_delegation" ("id" character varying NOT NULL, "amount" numeric NOT NULL, "round_id" character varying NOT NULL, "collator_id" character varying NOT NULL, "delegator_id" character varying NOT NULL, CONSTRAINT "PK_7c12d2edfea638d9d95be2d03b6" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_d422204258bc95c2441764028b" ON "round_delegation" ("round_id") `)
    await db.query(`CREATE INDEX "IDX_c037d1fb98a6b0646ee5ea903a" ON "round_delegation" ("collator_id") `)
    await db.query(`CREATE INDEX "IDX_d76abea91f20c2f2b560f40006" ON "round_delegation" ("delegator_id") `)
    await db.query(`CREATE TABLE "collator_round" ("id" character varying NOT NULL, "collator" text NOT NULL, "own_bond" numeric, "total_bond" numeric, "reward_amount" numeric, "apr" numeric, "apr_techn_numerator" numeric, "apr_techn_denominator" numeric, "round_id" character varying, CONSTRAINT "PK_e6d9c535136e9625727d0bc5109" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_80fc641c15dfa1cc9e758e9141" ON "collator_round" ("round_id") `)
    await db.query(`CREATE TABLE "round" ("id" character varying NOT NULL, "index" integer NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "started_at" integer NOT NULL, "ended_at" integer, "collators_count" integer NOT NULL, "total" numeric NOT NULL, CONSTRAINT "PK_34bd959f3f4a90eb86e4ae24d2d" PRIMARY KEY ("id"))`)
    await db.query(`CREATE TABLE "collator" ("id" character varying NOT NULL, "bond" numeric, "apr24h" numeric, CONSTRAINT "PK_2c92edad8b66a47d923ff5abe31" PRIMARY KEY ("id"))`)
    await db.query(`CREATE TABLE "delegator" ("id" character varying NOT NULL, CONSTRAINT "PK_a8359cef2656d4ecf83c3c20aa5" PRIMARY KEY ("id"))`)
    await db.query(`CREATE TABLE "delegator_history_element" ("id" character varying NOT NULL, "block_number" integer NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "type" integer NOT NULL, "amount" numeric NOT NULL, "delegator_id" character varying, "collator_id" character varying, "round_id" character varying NOT NULL, CONSTRAINT "PK_25165c5a7f193f9a19c75ff36f6" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_c1c2a313f53b68181f1ad6868d" ON "delegator_history_element" ("delegator_id") `)
    await db.query(`CREATE INDEX "IDX_c410482bced0f441b4316aae48" ON "delegator_history_element" ("collator_id") `)
    await db.query(`CREATE INDEX "IDX_a169f4fdea5e373575a3df8ef1" ON "delegator_history_element" ("round_id") `)
    await db.query(`CREATE TABLE "error_event" ("id" character varying NOT NULL, "description" text NOT NULL, CONSTRAINT "PK_c2e5dc904a1e06d26e1538544ed" PRIMARY KEY ("id"))`)
    await db.query(`ALTER TABLE "round_nominator" ADD CONSTRAINT "FK_51c3d9f8e416a26186881e95ccf" FOREIGN KEY ("round_id") REFERENCES "round"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "round_delegation" ADD CONSTRAINT "FK_d422204258bc95c2441764028b5" FOREIGN KEY ("round_id") REFERENCES "round"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "round_delegation" ADD CONSTRAINT "FK_c037d1fb98a6b0646ee5ea903a5" FOREIGN KEY ("collator_id") REFERENCES "collator_round"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "round_delegation" ADD CONSTRAINT "FK_d76abea91f20c2f2b560f400066" FOREIGN KEY ("delegator_id") REFERENCES "round_nominator"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "collator_round" ADD CONSTRAINT "FK_80fc641c15dfa1cc9e758e9141e" FOREIGN KEY ("round_id") REFERENCES "round"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "delegator_history_element" ADD CONSTRAINT "FK_c1c2a313f53b68181f1ad6868d9" FOREIGN KEY ("delegator_id") REFERENCES "delegator"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "delegator_history_element" ADD CONSTRAINT "FK_c410482bced0f441b4316aae485" FOREIGN KEY ("collator_id") REFERENCES "collator"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "delegator_history_element" ADD CONSTRAINT "FK_a169f4fdea5e373575a3df8ef13" FOREIGN KEY ("round_id") REFERENCES "round"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
  }

  async down(db) {
    await db.query(`DROP TABLE "round_nominator"`)
    await db.query(`DROP INDEX "public"."IDX_51c3d9f8e416a26186881e95cc"`)
    await db.query(`DROP INDEX "public"."IDX_321b9eb24f8fa2d07a70406a05"`)
    await db.query(`DROP TABLE "round_delegation"`)
    await db.query(`DROP INDEX "public"."IDX_d422204258bc95c2441764028b"`)
    await db.query(`DROP INDEX "public"."IDX_c037d1fb98a6b0646ee5ea903a"`)
    await db.query(`DROP INDEX "public"."IDX_d76abea91f20c2f2b560f40006"`)
    await db.query(`DROP TABLE "collator_round"`)
    await db.query(`DROP INDEX "public"."IDX_80fc641c15dfa1cc9e758e9141"`)
    await db.query(`DROP TABLE "round"`)
    await db.query(`DROP TABLE "collator"`)
    await db.query(`DROP TABLE "delegator"`)
    await db.query(`DROP TABLE "delegator_history_element"`)
    await db.query(`DROP INDEX "public"."IDX_c1c2a313f53b68181f1ad6868d"`)
    await db.query(`DROP INDEX "public"."IDX_c410482bced0f441b4316aae48"`)
    await db.query(`DROP INDEX "public"."IDX_a169f4fdea5e373575a3df8ef1"`)
    await db.query(`DROP TABLE "error_event"`)
    await db.query(`ALTER TABLE "round_nominator" DROP CONSTRAINT "FK_51c3d9f8e416a26186881e95ccf"`)
    await db.query(`ALTER TABLE "round_delegation" DROP CONSTRAINT "FK_d422204258bc95c2441764028b5"`)
    await db.query(`ALTER TABLE "round_delegation" DROP CONSTRAINT "FK_c037d1fb98a6b0646ee5ea903a5"`)
    await db.query(`ALTER TABLE "round_delegation" DROP CONSTRAINT "FK_d76abea91f20c2f2b560f400066"`)
    await db.query(`ALTER TABLE "collator_round" DROP CONSTRAINT "FK_80fc641c15dfa1cc9e758e9141e"`)
    await db.query(`ALTER TABLE "delegator_history_element" DROP CONSTRAINT "FK_c1c2a313f53b68181f1ad6868d9"`)
    await db.query(`ALTER TABLE "delegator_history_element" DROP CONSTRAINT "FK_c410482bced0f441b4316aae485"`)
    await db.query(`ALTER TABLE "delegator_history_element" DROP CONSTRAINT "FK_a169f4fdea5e373575a3df8ef13"`)
  }
}
